stages:  
  - build

install-dep:
  stage: build
  script:
    - |
      echo "Install dependenses ..."
      git submodule update --init --recursive
      cd RobustToolbox
      git submodule update --init --recursive

build-project:       # This job runs in the build stage, which runs first.
  stage: build
  needs: ["install-dep"]
  variables:
    GITHUB_ACTIONS: 1
  dependencies: []
  script:
    - |
      echo "Restore Projects ..."
      dotnet restore
      echo "Build Projects ..."
      dotnet build --configuration Release --no-restore /p:WarningsAsErrors= /m
      dotnet run --project Content.YAMLLinter/Content.YAMLLinter.csproj --no-build
      echo "Compile complete."

yaml-test:       # This job runs in the build stage, which runs first.
  stage: build
  needs: ["build-project"]
  variables:
    GITHUB_ACTIONS: 1
  dependencies: []
  script:
    - |
      dotnet run --project Content.YAMLLinter/Content.YAMLLinter.csproj --no-build
      echo "Compile complete."




remove-build:
  stage: .post
  when: on_failure
  script:
    - cd ..
    - rm -R space_station